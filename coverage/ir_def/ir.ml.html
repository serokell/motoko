<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>ir.ml &mdash; Coverage report</title>
    <meta name="description" content="74.51% coverage in ir_def/ir.ml">
    <link rel="stylesheet" href="../coverage.css"/>
    <script src="../highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="../index.html">
          <span class="dirname">ir_def/</span>ir.ml
        </a>
      </h1>
      <h2>74.51%</h2>
    </div>
    <div id="navbar">
      <span class="unvisited" style="bottom:39.31%"></span>
      <span class="unvisited" style="bottom:38.99%"></span>
      <span class="unvisited" style="bottom:38.68%"></span>
      <span class="unvisited" style="bottom:38.36%"></span>
      <span class="unvisited" style="bottom:38.05%"></span>
      <span class="unvisited" style="bottom:37.74%"></span>
      <span class="unvisited" style="bottom:37.42%"></span>
      <span class="unvisited" style="bottom:37.11%"></span>
      <span class="unvisited" style="bottom:36.79%"></span>
      <span class="unvisited" style="bottom:36.48%"></span>
      <span class="unvisited" style="bottom:36.16%"></span>
      <span class="unvisited" style="bottom:35.85%"></span>
      <span class="unvisited" style="bottom:35.53%"></span>
      <span class="unvisited" style="bottom:35.22%"></span>
      <span class="unvisited" style="bottom:34.91%"></span>
      <span class="unvisited" style="bottom:34.59%"></span>
      <span class="unvisited" style="bottom:34.28%"></span>
      <span class="unvisited" style="bottom:4.09%"></span>
      <span class="unvisited" style="bottom:3.77%"></span>
      <span class="unvisited" style="bottom:3.46%"></span>
      <span class="unvisited" style="bottom:2.52%"></span>
      <span class="unvisited" style="bottom:1.89%"></span>
      <span class="unvisited" style="bottom:1.57%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span > </span>
<a id="L10"></a><span > </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span > </span>
<a id="L13"></a><span > </span>
<a id="L14"></a><span > </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span > </span>
<a id="L19"></a><span > </span>
<a id="L20"></a><span > </span>
<a id="L21"></a><span > </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span > </span>
<a id="L24"></a><span > </span>
<a id="L25"></a><span > </span>
<a id="L26"></a><span > </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span > </span>
<a id="L29"></a><span > </span>
<a id="L30"></a><span > </span>
<a id="L31"></a><span > </span>
<a id="L32"></a><span > </span>
<a id="L33"></a><span > </span>
<a id="L34"></a><span > </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span > </span>
<a id="L38"></a><span > </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span > </span>
<a id="L41"></a><span > </span>
<a id="L42"></a><span > </span>
<a id="L43"></a><span > </span>
<a id="L44"></a><span > </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span > </span>
<a id="L47"></a><span > </span>
<a id="L48"></a><span > </span>
<a id="L49"></a><span > </span>
<a id="L50"></a><span > </span>
<a id="L51"></a><span > </span>
<a id="L52"></a><span > </span>
<a id="L53"></a><span > </span>
<a id="L54"></a><span > </span>
<a id="L55"></a><span > </span>
<a id="L56"></a><span > </span>
<a id="L57"></a><span > </span>
<a id="L58"></a><span > </span>
<a id="L59"></a><span > </span>
<a id="L60"></a><span > </span>
<a id="L61"></a><span > </span>
<a id="L62"></a><span > </span>
<a id="L63"></a><span > </span>
<a id="L64"></a><span > </span>
<a id="L65"></a><span > </span>
<a id="L66"></a><span > </span>
<a id="L67"></a><span > </span>
<a id="L68"></a><span > </span>
<a id="L69"></a><span > </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span > </span>
<a id="L72"></a><span > </span>
<a id="L73"></a><span > </span>
<a id="L74"></a><span > </span>
<a id="L75"></a><span > </span>
<a id="L76"></a><span > </span>
<a id="L77"></a><span > </span>
<a id="L78"></a><span > </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span > </span>
<a id="L81"></a><span > </span>
<a id="L82"></a><span > </span>
<a id="L83"></a><span > </span>
<a id="L84"></a><span > </span>
<a id="L85"></a><span > </span>
<a id="L86"></a><span > </span>
<a id="L87"></a><span > </span>
<a id="L88"></a><span > </span>
<a id="L89"></a><span > </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span > </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span > </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span > </span>
<a id="L99"></a><span > </span>
<a id="L100"></a><span > </span>
<a id="L101"></a><span > </span>
<a id="L102"></a><span > </span>
<a id="L103"></a><span > </span>
<a id="L104"></a><span > </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span > </span>
<a id="L107"></a><span > </span>
<a id="L108"></a><span > </span>
<a id="L109"></a><span > </span>
<a id="L110"></a><span > </span>
<a id="L111"></a><span > </span>
<a id="L112"></a><span > </span>
<a id="L113"></a><span > </span>
<a id="L114"></a><span > </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span > </span>
<a id="L119"></a><span > </span>
<a id="L120"></a><span > </span>
<a id="L121"></a><span > </span>
<a id="L122"></a><span > </span>
<a id="L123"></a><span > </span>
<a id="L124"></a><span > </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span > </span>
<a id="L128"></a><span > </span>
<a id="L129"></a><span > </span>
<a id="L130"></a><span > </span>
<a id="L131"></a><span > </span>
<a id="L132"></a><span > </span>
<a id="L133"></a><span > </span>
<a id="L134"></a><span > </span>
<a id="L135"></a><span > </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span > </span>
<a id="L138"></a><span > </span>
<a id="L139"></a><span > </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span > </span>
<a id="L144"></a><span > </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span > </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span > </span>
<a id="L149"></a><span > </span>
<a id="L150"></a><span > </span>
<a id="L151"></a><span > </span>
<a id="L152"></a><span > </span>
<a id="L153"></a><span > </span>
<a id="L154"></a><span > </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span > </span>
<a id="L157"></a><span > </span>
<a id="L158"></a><span > </span>
<a id="L159"></a><span > </span>
<a id="L160"></a><span > </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span > </span>
<a id="L163"></a><span > </span>
<a id="L164"></a><span > </span>
<a id="L165"></a><span > </span>
<a id="L166"></a><span > </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span > </span>
<a id="L169"></a><span > </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span > </span>
<a id="L172"></a><span > </span>
<a id="L173"></a><span > </span>
<a id="L174"></a><span > </span>
<a id="L175"></a><span > </span>
<a id="L176"></a><span > </span>
<a id="L177"></a><span > </span>
<a id="L178"></a><span > </span>
<a id="L179"></a><span > </span>
<a id="L180"></a><span > </span>
<a id="L181"></a><span > </span>
<a id="L182"></a><span > </span>
<a id="L183"></a><span > </span>
<a id="L184"></a><span > </span>
<a id="L185"></a><span > </span>
<a id="L186"></a><span > </span>
<a id="L187"></a><span > </span>
<a id="L188"></a><span > </span>
<a id="L189"></a><span > </span>
<a id="L190"></a><span > </span>
<a id="L191"></a><span > </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span class="unvisited"> </span>
<a id="L194"></a><span class="unvisited"> </span>
<a id="L195"></a><span class="unvisited"> </span>
<a id="L196"></a><span class="unvisited"> </span>
<a id="L197"></a><span class="unvisited"> </span>
<a id="L198"></a><span class="unvisited"> </span>
<a id="L199"></a><span class="unvisited"> </span>
<a id="L200"></a><span class="unvisited"> </span>
<a id="L201"></a><span class="unvisited"> </span>
<a id="L202"></a><span class="unvisited"> </span>
<a id="L203"></a><span class="unvisited"> </span>
<a id="L204"></a><span class="unvisited"> </span>
<a id="L205"></a><span class="unvisited"> </span>
<a id="L206"></a><span class="unvisited"> </span>
<a id="L207"></a><span class="unvisited"> </span>
<a id="L208"></a><span class="unvisited"> </span>
<a id="L209"></a><span class="unvisited"> </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span > </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span > </span>
<a id="L215"></a><span > </span>
<a id="L216"></a><span > </span>
<a id="L217"></a><span > </span>
<a id="L218"></a><span > </span>
<a id="L219"></a><span > </span>
<a id="L220"></a><span > </span>
<a id="L221"></a><span > </span>
<a id="L222"></a><span > </span>
<a id="L223"></a><span > </span>
<a id="L224"></a><span > </span>
<a id="L225"></a><span > </span>
<a id="L226"></a><span > </span>
<a id="L227"></a><span > </span>
<a id="L228"></a><span > </span>
<a id="L229"></a><span class="visited"> </span>
<a id="L230"></a><span > </span>
<a id="L231"></a><span > </span>
<a id="L232"></a><span > </span>
<a id="L233"></a><span > </span>
<a id="L234"></a><span > </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span > </span>
<a id="L237"></a><span > </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span > </span>
<a id="L241"></a><span > </span>
<a id="L242"></a><span > </span>
<a id="L243"></a><span > </span>
<a id="L244"></a><span > </span>
<a id="L245"></a><span > </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span > </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span class="visited"> </span>
<a id="L251"></a><span > </span>
<a id="L252"></a><span > </span>
<a id="L253"></a><span class="visited"> </span>
<a id="L254"></a><span > </span>
<a id="L255"></a><span > </span>
<a id="L256"></a><span class="visited"> </span>
<a id="L257"></a><span > </span>
<a id="L258"></a><span > </span>
<a id="L259"></a><span > </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span class="visited"> </span>
<a id="L262"></a><span class="visited"> </span>
<a id="L263"></a><span class="visited"> </span>
<a id="L264"></a><span class="visited"> </span>
<a id="L265"></a><span class="visited"> </span>
<a id="L266"></a><span class="visited"> </span>
<a id="L267"></a><span class="visited"> </span>
<a id="L268"></a><span class="visited"> </span>
<a id="L269"></a><span class="visited"> </span>
<a id="L270"></a><span class="visited"> </span>
<a id="L271"></a><span class="visited"> </span>
<a id="L272"></a><span class="visited"> </span>
<a id="L273"></a><span class="visited"> </span>
<a id="L274"></a><span class="visited"> </span>
<a id="L275"></a><span class="visited"> </span>
<a id="L276"></a><span class="visited"> </span>
<a id="L277"></a><span class="visited"> </span>
<a id="L278"></a><span class="visited"> </span>
<a id="L279"></a><span class="visited"> </span>
<a id="L280"></a><span class="visited"> </span>
<a id="L281"></a><span class="visited"> </span>
<a id="L282"></a><span class="visited"> </span>
<a id="L283"></a><span class="visited"> </span>
<a id="L284"></a><span class="visited"> </span>
<a id="L285"></a><span class="visited"> </span>
<a id="L286"></a><span class="visited"> </span>
<a id="L287"></a><span class="visited"> </span>
<a id="L288"></a><span class="visited"> </span>
<a id="L289"></a><span class="visited"> </span>
<a id="L290"></a><span class="visited"> </span>
<a id="L291"></a><span class="visited"> </span>
<a id="L292"></a><span class="visited"> </span>
<a id="L293"></a><span class="visited"> </span>
<a id="L294"></a><span class="visited"> </span>
<a id="L295"></a><span class="visited"> </span>
<a id="L296"></a><span class="visited"> </span>
<a id="L297"></a><span class="visited"> </span>
<a id="L298"></a><span class="visited"> </span>
<a id="L299"></a><span class="visited"> </span>
<a id="L300"></a><span class="visited"> </span>
<a id="L301"></a><span class="visited"> </span>
<a id="L302"></a><span class="visited"> </span>
<a id="L303"></a><span class="visited"> </span>
<a id="L304"></a><span class="visited"> </span>
<a id="L305"></a><span class="unvisited"> </span>
<a id="L306"></a><span class="unvisited"> </span>
<a id="L307"></a><span class="unvisited"> </span>
<a id="L308"></a><span class="visited"> </span>
<a id="L309"></a><span class="visited"> </span>
<a id="L310"></a><span class="unvisited"> </span>
<a id="L311"></a><span class="visited"> </span>
<a id="L312"></a><span class="unvisited"> </span>
<a id="L313"></a><span class="unvisited"> </span>
<a id="L314"></a><span class="visited"> </span>
<a id="L315"></a><span class="visited"> </span>
<a id="L316"></a><span class="visited"> </span>
<a id="L317"></a><span class="visited"> </span>
<a id="L318"></a><span > </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
</pre>
<pre><code class="ocaml">open Mo_types
open Mo_values

type id = string

(* Literals *)

type lit =
  | NullLit
  | BoolLit of bool
  | NatLit of Numerics.Nat.t
  | Nat8Lit of Numerics.Nat8.t
  | Nat16Lit of Numerics.Nat16.t
  | Nat32Lit of Numerics.Nat32.t
  | Nat64Lit of Numerics.Nat64.t
  | IntLit of Numerics.Int.t
  | Int8Lit of Numerics.Int_8.t
  | Int16Lit of Numerics.Int_16.t
  | Int32Lit of Numerics.Int_32.t
  | Int64Lit of Numerics.Int_64.t
  | FloatLit of Numerics.Float.t
  | CharLit of Value.unicode
  | TextLit of string
  | BlobLit of string

(* Patterns *)

type 'a phrase = ('a, Note.t) Source.annotated_phrase

type typ_bind' = {con : Type.con; sort : Type.bind_sort; bound : Type.typ}
type typ_bind = typ_bind' Source.phrase

type unop = Operator.unop
type binop = Operator.binop
type relop = Operator.relop

type mut = Const | Var

type pat = (pat', Type.typ) Source.annotated_phrase
and pat' =
  | WildP                                      (* wildcard *)
  | VarP of id                                 (* variable *)
  | LitP of lit                                (* literal *)
  | TupP of pat list                           (* tuple *)
  | ObjP of pat_field list                     (* object *)
  | OptP of pat                                (* option *)
  | TagP of Type.lab * pat                     (* variant *)
  | AltP of pat * pat                          (* disjunctive *)

and pat_field = pat_field' Source.phrase
and pat_field' = {name : Type.lab; pat : pat}

(* Like id, but with a type attached *)
type arg = (string, Type.typ) Source.annotated_phrase

(* Expressions *)

type exp = exp' phrase
and exp' =
  | PrimE of (prim * exp list)                 (* primitive *)
  | VarE of id                                 (* variable *)
  | LitE of lit                                (* literal *)
  | AssignE of lexp * exp                      (* assignment *)
  | BlockE of (dec list * exp)                 (* block *)
  | IfE of exp * exp * exp                     (* conditional *)
  | SwitchE of exp * case list                 (* switch *)
  | LoopE of exp                               (* do-while loop *)
  | LabelE of id * Type.typ * exp              (* label *)
  | AsyncE of Type.async_sort * typ_bind * exp * Type.typ        (* async/async* *)
  | DeclareE of id * Type.typ * exp            (* local promise *)
  | DefineE of id * mut * exp                  (* promise fulfillment *)
  | FuncE of                                   (* function *)
      string * Type.func_sort * Type.control * typ_bind list * arg list * Type.typ list * exp
  | SelfCallE of Type.typ list * exp * exp * exp (* essentially ICCallPrim (FuncE shared…) *)
  | ActorE of dec list * field list * system * Type.typ (* actor *)
  | NewObjE of Type.obj_sort * field list * Type.typ  (* make an object *)
  | TryE of exp * case list                    (* try/catch *)

and system = {
  meta : meta;
  (* TODO: use option expressions for (some or all of) these *)
  preupgrade : exp;
  postupgrade : exp;
  heartbeat : exp;
  timer : exp; (* TODO: use an option type: (Default of exp | UserDefined of exp) option *)
  inspect : exp
}

and candid = {
    args : string;
    service : string;
  }

and meta = {
    candid : candid;  (* Candid (of service, never actor class) *)
    sig_ : string  (* Motoko stable signature *)
  }

and field = (field', Type.typ) Source.annotated_phrase
and field' = {name : Type.lab; var : id} (* the var is by reference, not by value *)

and case = case' Source.phrase
and case' = {pat : pat; exp : exp}

and lexp = (lexp', Type.typ) Source.annotated_phrase
and lexp' =
  | VarLE of id                                (* variable *)
  | IdxLE of exp * exp                         (* array indexing *)
  | DotLE of exp * Type.lab                    (* object projection *)


(* In the IR, a prim is any AST node that has expr subexpressions, but they are
all call-by-value. Many passes can treat them uniformly, so they are unified
using the PrimE node. *)
and prim =
  | CallPrim of Type.typ list         (* function call *)
  | UnPrim of Type.typ * unop         (* unary operator *)
  | BinPrim of Type.typ * binop       (* binary operator *)
  | RelPrim of Type.typ * relop       (* relational operator *)
  | TupPrim                           (* the tuple constructor *)
  | ProjPrim of int                   (* tuple projection *)
  | OptPrim                           (* option injection *)
  | TagPrim of id                     (* variant injection *)
  | DotPrim of Type.lab               (* object projection *)
  | ActorDotPrim of Type.lab          (* actor field access *)
  | ArrayPrim of mut * Type.typ       (* array constructor *)
  | IdxPrim                           (* array indexing *)
  | BreakPrim of id                   (* break *)
  | RetPrim                           (* return *)
  | AwaitPrim of Type.async_sort       (* await/await* *)
  | AssertPrim                        (* assertion *)
  | ThrowPrim                         (* throw *)
  | ShowPrim of Type.typ              (* debug_show *)
  | SerializePrim of Type.typ list    (* Candid serialization prim *)
  | DeserializePrim of Type.typ list  (* Candid deserialization prim *)
  | DeserializeOptPrim of Type.typ list
     (* Candid deserialization prim (returning Opt) *)
  | NumConvTrapPrim of Type.prim * Type.prim
  | NumConvWrapPrim of Type.prim * Type.prim
  | DecodeUtf8
  | EncodeUtf8
  | CastPrim of Type.typ * Type.typ   (* representationally a noop *)
  | ActorOfIdBlob of Type.typ
  | BlobOfIcUrl                       (* traps on syntax or checksum failure *)
  | IcUrlOfBlob
  | SelfRef of Type.typ               (* returns the self actor ref *)
  | SystemTimePrim
  (* Array field iteration/access *)
  | NextArrayOffset of spacing        (* advance array offset *)
  | ValidArrayOffset                  (* verify array offset *)
  | DerefArrayOffset                  (* array offset indexing *)
  | GetPastArrayOffset of spacing     (* array offset past the last element *)
  (* Funds *)
  | SystemCyclesAddPrim
  | SystemCyclesAcceptPrim
  | SystemCyclesAvailablePrim
  | SystemCyclesBalancePrim
  | SystemCyclesRefundedPrim
  | SetCertifiedData
  | GetCertificate

  | OtherPrim of string               (* Other primitive operation, no custom typing rule *)
  (* backend stuff *)
  | CPSAwait of Type.async_sort * Type.typ
                                      (* typ is the current continuation type of cps translation *)
  | CPSAsync of Type.async_sort * Type.typ
  | ICPerformGC
  | ICReplyPrim of Type.typ list
  | ICRejectPrim
  | ICCallerPrim
  | ICCallPrim
  | ICCallRawPrim
  | ICMethodNamePrim
  | ICArgDataPrim
  | ICStableWrite of Type.typ          (* serialize value of stable type to stable memory *)
  | ICStableRead of Type.typ           (* deserialize value of stable type from stable memory *)
  | ICStableSize of Type.typ

and spacing = One | ElementSize        (* increment units when iterating over arrays *)

(* Declarations *)

and dec = dec' Source.phrase
and dec' =
  | LetD of pat * exp                          (* immutable *)
  | VarD of id * Type.typ * exp                (* mutable *)
  | RefD of id * Type.typ * lexp               (* reference - only required for flag --experimental_field_aliasing *)

(* Literals *)

(* NB: This function is currently unused *)
let string_of_lit = function
  | <span data-count="0">B</span>oolLit false -&gt; "false"
  | <span data-count="0">B</span>oolLit true  -&gt;  "true"
  | <span data-count="0">I</span>ntLit n
  | <span data-count="0">N</span>atLit n      -&gt; Numerics.Int.to_pretty_string n
  | <span data-count="0">I</span>nt8Lit n     -&gt; Numerics.Int_8.to_pretty_string n
  | <span data-count="0">I</span>nt16Lit n    -&gt; Numerics.Int_16.to_pretty_string n
  | <span data-count="0">I</span>nt32Lit n    -&gt; Numerics.Int_32.to_pretty_string n
  | <span data-count="0">I</span>nt64Lit n    -&gt; Numerics.Int_64.to_pretty_string n
  | <span data-count="0">N</span>at8Lit n     -&gt; Numerics.Nat8.to_pretty_string n
  | <span data-count="0">N</span>at16Lit n    -&gt; Numerics.Nat16.to_pretty_string n
  | <span data-count="0">N</span>at32Lit n    -&gt; Numerics.Nat32.to_pretty_string n
  | <span data-count="0">N</span>at64Lit n    -&gt; Numerics.Nat64.to_pretty_string n
  | <span data-count="0">C</span>harLit c     -&gt; string_of_int c
  | <span data-count="0">N</span>ullLit       -&gt; "null"
  | <span data-count="0">T</span>extLit t     -&gt; t
  | <span data-count="0">B</span>lobLit b     -&gt; Printf.sprintf "%s" b
  | <span data-count="0">F</span>loatLit f    -&gt; Numerics.Float.to_pretty_string f

(* Flavor *)

(*
We have a bunch of flavors of the IR, where some constructors are not
allowed in some flavors. In an ideal world, we would have different IRs for
that (or maybe GADTs). But for now we simply track that on the value level. The
main purpose of tracking that is to inform `Check_ir` about the invariants that
should hold.
*)

type flavor = {
  has_typ_field : bool; (* Typ(e) fields *)
  has_async_typ : bool; (* AsyncT *)
  has_await : bool; (* AwaitE and AsyncE *)
  has_show : bool; (* ShowE *)
  has_poly_eq : bool; (* Polymorphic equality *)
}

let full_flavor () : flavor = <span data-count="2619">{</span>
  has_typ_field = true;
  has_await = true;
  has_async_typ = true;
  has_show = true;
  has_poly_eq = true;
}


(* Program *)

type comp_unit =
  | LibU of dec list * exp
  | ProgU of dec list
  | ActorU of arg list option * dec list * field list * system * Type.typ (* actor (class) *)

type prog = comp_unit * flavor


(* object pattern helpers *)

let pats_of_obj_pat pfs = <span data-count="80715">L</span>ist.map (fun {Source.it={name; pat}; _} -&gt; <span data-count="117018">p</span>at) pfs

let map_obj_pat f pfs =
  <span data-count="5546">L</span>ist.map (fun ({Source.it={name; pat}; _} as pf) -&gt; <span data-count="9282">{</span>pf with Source.it={name; pat=<span data-count="9282">f</span> pat}}) pfs

let replace_obj_pat pfs pats =
  <span data-count="3545">L</span>ist.map2 (fun ({Source.it={name; pat=_}; _} as pf) pat -&gt; <span data-count="3605">{</span>pf with Source.it={name; pat}}) pfs pats

(* Helper for transforming prims, without missing embedded typs and ids *)

let map_prim t_typ t_id p =
  <span data-count="1355105">m</span>atch p with
  | <span data-count="223074">C</span>allPrim ts -&gt; CallPrim (List.ma<span data-count="223074">p</span> t_typ ts)
  | <span data-count="293">U</span>nPrim (ot, op) -&gt; UnPrim (t_ty<span data-count="293">p</span> ot, op)
  | <span data-count="105122">B</span>inPrim (ot, op) -&gt; BinPrim (t_ty<span data-count="105122">p</span> ot, op)
  | <span data-count="101523">R</span>elPrim (ot, op) -&gt; RelPrim (t_ty<span data-count="101523">p</span> ot, op)
  | <span data-count="219982">T</span>upPrim
  | <span data-count="2525">P</span>rojPrim _
  | <span data-count="49693">O</span>ptPrim
  | <span data-count="25958">T</span>agPrim _
  | <span data-count="157664">D</span>otPrim _
  | <span data-count="11888">A</span>ctorDotPrim _ -&gt; p
  | <span data-count="6364">A</span>rrayPrim (m, t) -&gt; ArrayPrim (m, t_ty<span data-count="6364">p</span> t)
  | <span data-count="33544">I</span>dxPrim
  | <span data-count="6364">N</span>extArrayOffset _
  | <span data-count="6364">V</span>alidArrayOffset
  | <span data-count="6276">D</span>erefArrayOffset
  | <span data-count="6364">G</span>etPastArrayOffset _ -&gt; p
  | <span data-count="15501">B</span>reakPrim id -&gt; BreakPrim (t_i<span data-count="15501">d</span> id)
  | <span data-count="18739">R</span>etPrim
  | <span data-count="11737">A</span>waitPrim _
  | <span data-count="15263">A</span>ssertPrim
  | <span data-count="172">T</span>hrowPrim -&gt; p
  | <span data-count="879">S</span>howPrim t -&gt; ShowPrim (t_ty<span data-count="879">p</span> t)
  | <span data-count="489">S</span>erializePrim ts -&gt; SerializePrim (List.ma<span data-count="489">p</span> t_typ ts)
  | <span data-count="82">D</span>eserializePrim ts -&gt; DeserializePrim (List.ma<span data-count="82">p</span> t_typ ts)
  | <span data-count="199">D</span>eserializeOptPrim ts -&gt; DeserializeOptPrim (List.ma<span data-count="199">p</span> t_typ ts)
  | <span data-count="42340">N</span>umConvTrapPrim _
  | <span data-count="20564">N</span>umConvWrapPrim _
  | <span data-count="1008">D</span>ecodeUtf8
  | <span data-count="1008">E</span>ncodeUtf8 -&gt; p
  | <span data-count="13209">C</span>astPrim (t1, t2) -&gt; CastPrim (t_ty<span data-count="13209">p</span> t1, t_ty<span data-count="13209">p</span> t2)
  | <span data-count="2303">A</span>ctorOfIdBlob t -&gt; ActorOfIdBlob (t_ty<span data-count="2303">p</span> t)
  | <span data-count="2277">B</span>lobOfIcUrl
  | <span data-count="35">I</span>cUrlOfBlob -&gt; p
  | <span data-count="2430">S</span>elfRef t -&gt; SelfRef (t_ty<span data-count="2430">p</span> t)
  | <span data-count="5293">S</span>ystemTimePrim
  | <span data-count="1714">S</span>ystemCyclesAddPrim
  | <span data-count="6150">S</span>ystemCyclesAcceptPrim
  | <span data-count="6150">S</span>ystemCyclesAvailablePrim
  | <span data-count="1008">S</span>ystemCyclesBalancePrim
  | <span data-count="1714">S</span>ystemCyclesRefundedPrim
  | <span data-count="1008">S</span>etCertifiedData
  | <span data-count="1008">G</span>etCertificate
  | <span data-count="213672">O</span>therPrim _ -&gt; p
  | <span data-count="0">C</span>PSAwait (s, t) -&gt; CPSAwait (s, t_ty<span data-count="0">p</span> t)
  | <span data-count="0">C</span>PSAsync (s, t) -&gt; CPSAsync (s, t_ty<span data-count="0">p</span> t)
  | <span data-count="0">I</span>CReplyPrim ts -&gt; ICReplyPrim (List.ma<span data-count="0">p</span> t_typ ts)
  | <span data-count="20">I</span>CArgDataPrim
  | <span data-count="182">I</span>CPerformGC
  | <span data-count="0">I</span>CRejectPrim
  | <span data-count="1961">I</span>CCallerPrim
  | <span data-count="0">I</span>CCallPrim
  | <span data-count="0">I</span>CCallRawPrim
  | <span data-count="20">I</span>CMethodNamePrim -&gt; p
  | <span data-count="1154">I</span>CStableWrite t -&gt; ICStableWrite (t_ty<span data-count="1154">p</span> t)
  | <span data-count="1154">I</span>CStableRead t -&gt; ICStableRead (t_ty<span data-count="1154">p</span> t)
  | <span data-count="1664">I</span>CStableSize t -&gt; ICStableSize (t_ty<span data-count="1664">p</span> t)

</code></pre>
      </div>
    </div>
    <script src="../coverage.js"></script>
  </body>
</html>
